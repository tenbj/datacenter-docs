# 交易域 (trd) 数据域详情	

> **优先级**: P0（核心域）	
> **数据库编码**: `trd`	
> **核心业务**: 订单、支付、结算	

---

## 1. 域定义	

交易域覆盖跨境电商业务中从购物车到订单完成的全流程交易数据，是数据仓库的核心数据域。	

---

## 2. 业务过程清单	

| 序号 | 业务过程 | 英文名称 | 描述 | 事实表类型 |	
|------|----------|----------|------|------------|	
| 1 | 加入购物车 | add_to_cart | 用户将商品加入购物车的行为 | 事务事实 |	
| 2 | 创建订单 | create_order | 用户提交订单的行为 | 事务事实 |	
| 3 | 订单明细 | order_detail | 订单中每个商品明细 | 事务事实 |	
| 4 | 支付订单 | pay_order | 用户完成订单支付 | 事务事实 |	
| 5 | 结算订单 | settle_order | 平台完成订单结算 | 事务事实 |	
| 6 | 发布评价 | submit_review | 用户对订单发表评价 | 事务事实 |	

---

## 3. 粒度定义	

| 业务过程 | 粒度声明 | 主键组成 | 时间粒度 |	
|----------|----------|----------|----------|	
| 加入购物车 | 每一行代表一次用户将某商品加入购物车的行为 | 购物车ID + 商品ASIN + 时间戳 | 事件时间 |	
| 创建订单 | 每一行代表一笔订单的创建事件 | 订单ID | 订单创建时间 |	
| 订单明细 | 每一行代表一笔订单中的一个商品明细 | 订单ID + 订单明细行号 | 订单创建时间 |	
| 支付订单 | 每一行代表一笔订单的一次支付事件 | 订单ID + 支付ID | 支付时间 |	
| 结算订单 | 每一行代表一笔订单的一次平台结算记录 | 订单ID + 结算ID | 结算时间 |	
| 发布评价 | 每一行代表一条用户评价记录 | 评价ID | 评价发布时间 |	

---

## 4. 维度清单	

### 4.1 公共维度	

| 维度 | 英文名称 | 使用场景 |	
|------|----------|----------|	
| ✓ 时间维度 | dim_date | 所有业务过程 |	
| ✓ 产品维度 | dim_product | 订单明细、评价 |	
| ✓ 变体维度 | dim_variant | 订单明细 |	
| ✓ 店铺维度 | dim_store | 订单、支付、结算 |	
| ✓ 站点维度 | dim_marketplace | 订单、支付、结算 |	
| ✓ 类目维度 | dim_category | 订单明细 |	

### 4.2 专属维度	

| 编号 | 维度名称 | 英文名称 | 主键 | 说明 |	
|------|----------|----------|------|------|	
| DIM-11 | 支付方式维度 | dim_payment_method | payment_method_key | 支付方式（信用卡、礼品卡等） |	
| DIM-12 | 订单状态维度 | dim_order_status | order_status_key | 订单状态（待支付、已发货等） |	
| DIM-13 | 评价等级维度 | dim_review_rating | rating_key | 评价星级（1-5星） |	

---

## 5. 事实表设计	

| 编号 | 事实表名称 | 英文表名 | 类型 | 更新频率 | 说明 |	
|------|-----------|----------|------|----------|------|	
| FCT-01 | 订单事实表 | fct_trd_order | 事务事实 | 实时/日 | 记录每笔订单创建事件 |	
| FCT-02 | 订单明细事实表 | fct_trd_order_detail | 事务事实 | 实时/日 | 记录订单中每个商品明细 |	
| FCT-03 | 支付事实表 | fct_trd_payment | 事务事实 | 实时/日 | 记录每笔支付事件 |	
| FCT-04 | 结算事实表 | fct_trd_settlement | 事务事实 | 日 | 记录平台结算记录 |	
| FCT-05 | 评价事实表 | fct_trd_review | 事务事实 | 日 | 记录用户评价 |	
| FCT-06 | 订单履约累积快照 | fct_trd_order_fulfillment | 累积快照 | 实时/日 | 跟踪订单从创建到签收的全流程 |	

---

## 6. 总线矩阵（该域）	

| 业务过程 | 时间 | 产品 | 变体 | 店铺 | 站点 | 类目 | 支付方式 | 订单状态 | 评价等级 |	
|----------|------|------|------|------|------|------|----------|----------|----------|	
| 创建订单 | ✓ | | | ✓ | ✓ | | | ✓ | |	
| 订单明细 | ✓ | ✓ | ✓ | ✓ | ✓ | ✓ | | ✓ | |	
| 支付订单 | ✓ | | | ✓ | ✓ | | ✓ | | |	
| 结算订单 | ✓ | | | ✓ | ✓ | | | | |	
| 发布评价 | ✓ | ✓ | | | ✓ | | | | ✓ |	

---

## 7. 典型度量指标	

| 指标名称 | 指标说明 | 聚合方式 |	
|----------|----------|----------|	
| 订单数 | 订单总数 | SUM |	
| 订单金额 | 订单总金额 | SUM |	
| 支付金额 | 支付总金额 | SUM |	
| 结算金额 | 平台结算总金额 | SUM |	
| 平台费用 | 平台扣费总额 | SUM |	
| 评价数 | 评价总数 | SUM |	
| 平均评分 | 平均评价星级 | AVG |	

---

## 8. 累积快照 - 订单履约全流程	

**跟踪阶段**：创建订单 → 支付订单 → 发货 → 物流运输 → 签收 → 评价	

**里程碑时间字段**：	
- `order_create_time` - 订单创建时间	
- `payment_time` - 支付完成时间	
- `ship_time` - 发货时间	
- `deliver_time` - 签收时间	
- `review_time` - 评价时间	

---

*文档版本: v1.0 | 创建日期: 2026-01-15*	
