# 数据域建设评估标准

> **文档目的**: 建立数据域建设的量化评估体系  
> **适用范围**: 所有数据域建设项目  
> **示范数据域**: 交易域 (Trade / trd)  
> **版本**: v1.0  
> **更新日期**: 2026-01-09

---

## 1. 评估体系概览

### 1.1 五维度评分体系

我们建立了五个维度的评估体系，用于全面衡量数据域建设质量：

| 评估维度 | 权重 | 说明 | 关注点 |
|---------|------|------|--------|
| **完整性** | 30% | 业务过程覆盖程度 | 建设范围 |
| **规范性** | 20% | 命名、类型等规范性 | 建设标准 |
| **一致性** | 20% | 跨表维度一致性 | 数据质量 |
| **准确性** | 15% | 数据血缘、逻辑准确性 | 逻辑正确 |
| **有效性** | 15% | 去重、时效性、可用性 | 实用价值 |

### 1.2 评级标准

| 等级 | 分数区间 | 说明 |
|------|---------|------|
| 优秀 ⭐⭐⭐⭐⭐ | 90-100分 | 建设完善，可作为标杆 |
| 良好 ⭐⭐⭐⭐ | 80-89分 | 建设较好，有小问题 |
| 合格 ⭐⭐⭐ | 70-79分 | 基本达标，需改进 |
| 需改进 ⭐⭐ | 60-69分 | 有明显问题，需整改 |
| 不合格 ⭐ | <60分 | 建设不足，需重建 |

---

## 2. 维度1: 完整性 (权重30%)

### 2.1 定义

业务过程覆盖的完整程度

### 2.2 计算公式

```
完整性 = (已建设的业务过程数 + 0.5 × 部分建设的业务过程数) ÷ 应建设的业务过程总数
```

### 2.3 示例计算（交易域）

**输入数据**:
- 应建设业务过程: 6个
- 完整建设: 4个
- 部分建设: 1个（50%）
- 未建设: 2个

**计算过程**:
```
完整性 = (4 + 0.5 × 1) ÷ 6 = 4.5 ÷ 6 = 75%
```

调整后（考虑超标准表）: **67%**

### 2.4 明细表

| 业务过程 | 应有表 | 实有表 | 贡献度 |
|---------|-------|-------|--------|
| 购物车管理 | 1 | 0 | 0% |
| 订单生成 | 1 | 1 | 100% |
| 订单明细 | 1 | 1 | 100% |
| 支付处理 | 1 | 0 | 0% |
| 结算对账 | 1 | 1 | 100% |
| 订单评价 | 1 | 0.5 | 50% |

---

## 3. 维度2: 规范性 (权重20%)

### 3.1 定义

表命名、字段命名、数据类型等是否符合规范

### 3.2 计算公式

```
规范性 = 符合规范的检查项数 ÷ 总检查项数
```

### 3.3 检查项（20项）

| 检查项 | 要求 | 实际 | 是否合规 |
|--------|------|------|---------|
| **命名规范** (8项) | | | |
| 表名前缀 | dwd_trd_ | ✅ 统一 | ✅ |
| 平台标识 | amz/dp等 | ✅ 统一 | ✅ |
| 业务主题 | order/stlmt | ✅ 清晰 | ✅ |
| 表名长度 | ≤50字符 | ✅ 符合 | ✅ |
| 字段命名 | 下划线命名法 | ✅ 统一 | ✅ |
| 时间字段后缀 | _date/_time | ✅ 统一 | ✅ |
| 金额字段后缀 | _amt/_fee | ✅ 统一 | ✅ |
| ID字段命名 | _id/_no | ✅ 统一 | ✅ |
| **字段规范** (7项) | | | |
| 主键定义 | 必须有主键 | ✅ 有 | ✅ |
| 时间字段类型 | timestamp/date | ✅ 统一 | ✅ |
| 金额字段类型 | decimal(18,2) | ✅ 统一 | ✅ |
| 必填字段 | not null约束 | ✅ 有 | ✅ |
| 字段注释 | 必须有注释 | ✅ 完整 | ✅ |
| 枚举值规范 | 使用标准码表 | ⚠️ 部分 | ⚠️ |
| 默认值设置 | 合理默认值 | ✅ 有 | ✅ |
| **分区规范** (3项) | | | |
| 分区字段 | 按日期分区 | ✅ 统一 | ✅ |
| 分区命名 | yyyyMMdd格式 | ✅ 统一 | ✅ |
| 分区保留 | 有保留策略 | ✅ 有 | ✅ |
| **注释规范** (2项) | | | |
| 表注释 | 必须有 | ✅ 完整 | ✅ |
| 字段注释 | 必须有 | ✅ 完整 | ✅ |

**计算结果**:
```
规范性 = 19 ÷ 20 = 95%
```

---

## 4. 维度3: 一致性 (权重20%)

### 4.1 定义

相同维度在不同表中的标准化一致程度

### 4.2 计算公式

```
一致性 = 标准化一致的核心维度数 ÷ 核心维度总数
```

### 4.3 核心维度检查（8个）

| 维度字段 | 标准化要求 | 一致表数 | 总表数 | 一致性 |
|---------|-----------|---------|-------|--------|
| **MSKU** | 大写+横线分隔 | 3 | 8 | ❌ 37.5% |
| **order_id** | 统一格式 | 8 | 8 | ✅ 100% |
| **shop_id** | 统一编码 | 8 | 8 | ✅ 100% |
| **currency_code** | ISO 4217标准 | 8 | 8 | ✅ 100% |
| **时间维度** | timestamp格式 | 8 | 8 | ✅ 100% |
| **金额维度** | decimal(18,2) | 8 | 8 | ✅ 100% |
| **平台编码** | 统一枚举 | 8 | 8 | ✅ 100% |
| **国家代码** | ISO 3166标准 | 8 | 8 | ✅ 100% |

### 4.4 MSKU不一致详情

| 表名 | MSKU格式 | 标准化 |
|------|---------|--------|
| dwd_trd_amz_order_main | B07-ABC-123 | ✅ 标准 |
| dwd_trd_amz_order_detail | B07-ABC-123 | ✅ 标准 |
| dwd_trd_amz_stlmt_tx_detail | B07-ABC-123 | ✅ 标准 |
| dwd_trd_amz_vat_tx_report | b07_abc_123 | ❌ 未标准化 |
| dwd_trd_dp_order_main | B07ABC123 | ❌ 未标准化 |
| dwd_trd_dp_order_detail | b07_abc_123 | ❌ 未标准化 |
| 其他表1 | 混合格式 | ❌ 未标准化 |
| 其他表2 | 混合格式 | ❌ 未标准化 |

**计算结果**:
```
MSKU一致性 = 3 ÷ 8 = 37.5%
```

> [!WARNING]
> 因MSKU是核心关联维度，权重加倍，实际一致性评分为 **37.5%**（取最低项）

---

## 5. 维度4: 准确性 (权重15%)

### 5.1 定义

数据来源、加工逻辑、血缘关系的准确性

### 5.2 计算公式

```
准确性 = 准确的检查项数 ÷ 总检查项数
```

### 5.3 检查项（10项）

| 检查项 | 要求 | 实际情况 | 是否准确 |
|--------|------|---------|---------|
| **数据血缘** (5项) | | | |
| 源表明确 | 能追溯到ODS | ✅ 清晰 | ✅ |
| 加工逻辑 | 有SQL文档 | ✅ 完整 | ✅ |
| 字段映射 | 有映射文档 | ✅ 清晰 | ✅ |
| 业务规则 | 逻辑正确 | ✅ 正确 | ✅ |
| 依赖关系 | 依赖清晰 | ✅ 清晰 | ✅ |
| **数据质量** (5项) | | | |
| 主键唯一性 | 无重复 | ✅ 唯一 | ✅ |
| 空值处理 | 符合业务 | ✅ 合理 | ✅ |
| 数据类型 | 类型正确 | ✅ 正确 | ✅ |
| 关联准确性 | JOIN正确 | ✅ 正确 | ✅ |
| 计算准确性 | 计算正确 | ✅ 正确 | ✅ |

**计算结果**:
```
准确性 = 10 ÷ 10 = 100%
```

---

## 6. 维度5: 有效性 (权重15%)

### 6.1 定义

数据去重、时效性、可用性

### 6.2 计算公式

```
有效性 = 有效的检查项数 ÷ 总检查项数
```

### 6.3 检查项（10项）

| 检查项 | 要求 | 实际情况 | 是否有效 |
|--------|------|---------|---------|
| **去重逻辑** (4项) | | | |
| 主键去重 | 有去重逻辑 | ✅ 完善 | ✅ |
| 全量去重 | row_number() | ✅ 正确 | ✅ |
| 增量去重 | merge去重 | ✅ 正确 | ✅ |
| 历史数据 | 拉链表机制 | ✅ 有 | ✅ |
| **时效性** (3项) | | | |
| 更新频率 | 天级更新 | ✅ T+1 | ✅ |
| 延迟时间 | <2小时 | ✅ 符合 | ✅ |
| 数据完整性 | 不缺日期 | ✅ 完整 | ✅ |
| **可用性** (3项) | | | |
| 查询性能 | <5秒 | ✅ 正常 | ✅ |
| 分区有效 | 分区剪枝 | ✅ 有效 | ✅ |
| 统计信息 | 定期更新 | ✅ 更新 | ✅ |

**计算结果**:
```
有效性 = 10 ÷ 10 = 100%
```

---

## 7. 总分计算

### 7.1 加权平均公式

```
总分 = 完整性 × 30% + 规范性 × 20% + 一致性 × 20% + 准确性 × 15% + 有效性 × 15%
```

### 7.2 交易域实际得分

```
总分 = 67% × 0.3 + 95% × 0.2 + 37.5% × 0.2 + 100% × 0.15 + 100% × 0.15
     = 20.1 + 19.0 + 7.5 + 15.0 + 15.0
     = 76.6分
```

**评级**: 合格 ⭐⭐⭐

### 7.3 提升路径

| 优先级 | 改进项 | 提升幅度 | 提升后得分 | 新评级 |
|-------|-------|---------|-----------|--------|
| 🔴 紧急 | 修复一致性问题（37.5%→100%） | +12.5分 | 89.1分 | 良好 ⭐⭐⭐⭐ |
| 🟡 重要 | 补齐缺失业务过程（67%→100%） | +9.9分 | 99.0分 | 优秀 ⭐⭐⭐⭐⭐ |
| 🟢 优化 | 完善枚举值规范（95%→100%） | +1.0分 | 100分 | 优秀 ⭐⭐⭐⭐⭐ |

---

## 8. 使用指南

### 8.1 评估流程

**步骤1**: 确认业务过程清单  
**步骤2**: 逐维度检查评分  
**步骤3**: 汇总计算总分  
**步骤4**: 识别问题项  
**步骤5**: 制定改进计划

### 8.2 评估周期

| 数据域优先级 | 评估频率 | 说明 |
|------------|---------|------|
| P0核心域 | 每月 | 持续监控 |
| P1重要域 | 每季度 | 定期检查 |
| P2-P3域 | 每半年 | 阶段性评估 |

---

**文档版本**: v1.0  
**更新日期**: 2026-01-09  
**维护人员**: 数据架构团队
